<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="stylesheets/newproject.css">
    <meta charset="UTF-8">
    <title>New Project</title>
</head>
<body>
    <div id="mainBar">
        <div class="cell">
            <img src="images/newDocument.png" style="height:30px">
            <div>Nový dokument</div>
        </div>
        <div class="cell">
            <img src="images/HouslovyKEY.png">
            <div>Klíč</div>
        </div>
        <div class="cell">
            <img src="images/HouslovyKEY.png">
            <div>Stupnice</div>
        </div>
        <div class="cell">
            <img src="images/HouslovyKEY.png">
            <div>Dynamika</div>
        </div>
        <div class="cell">
            <img src="images/HouslovyKEY.png">
            <div>Opakování</div>
        </div>

    </div>
    <div id="tools">
        <div class="tool" h="" x="" y="" id="cursor" value="50" style="background:radial-gradient(circle, rgb(255, 255, 255) 0%, rgb(167, 167, 167) 100%)"><img src="images/cursor.png"></div>
        <div class="" h="" x="" y="" value=""></div>
        <div class="" h="" x="" y="" value=""></div>
        <div class="" h="" x="" y="" value=""></div>
        <div class="" h="" x="" y="" value=""></div>
        <div class="" h="" x="" y="" value=""></div>
        <div class="" h="" x="" y="" value=""></div>
        <div class="tool" h="35" x="50" y="-16" value="0"><img src="images/celaNota.png"></div>
        <div class="tool" h="35" x="50" y="-26" value="1"><img src="images/pulovaNota.png"></div>
        <div class="tool" h="35" x="50" y="-26" value="2"><img src="images/ctvrtovaNota.png"></div>
        <div class="tool" h="35" x="48" y="-26" value="3"><img src="images/osminkaNota.png"></div>
        <div class="tool" h="35" x="48" y="-26" value="4"><img src="images/sestnatinkaNota.png"></div>
        <div class="tool" h="35" x="47" y="-26" value="5"><img src="images/tricetidvatinkaNota.png"></div>
        <div class="tool" h="40" x="50" y="-26" value="6"><img src="images/sedesatictyritinkaNota.png"></div>
        <div class="tool" h="35" x="58" y="-15" value="7"><img src="images/celaPomlka.png"></div>
        <div class="tool" h="35" x="58" y="-15" value="8"><img src="images/pulovaPomlka.png"></div>
        <div class="tool" h="35" x="50" y="-15" value="9"><img src="images/ctvrtovaPomlka.png"></div>
        <div class="tool" h="35" x="50" y="-15" value="10"><img src="images/osminkaPomlka.png"></div>
        <div class="tool" h="35" x="50" y="-10" value="11"><img src="images/sestnatinkovaPomlka.png"></div>
        <div class="tool" h="40" x="58" y="-15" value="12"><img src="images/tricetidvatinkaPomlka.png"></div>
        <div class="tool" h="45" x="48" y="-20" value="13"><img src="images/taktovaCara.png"></div>
    </div>
    <div id="Tacts">
        <img src="images/Takt22.png">
        <img src="images/Takt24.png">
        <img src="images/Takt28.png">
        <img src="images/Takt32.png">
        <img src="images/Takt34.png">
        <img src="images/Takt38.png">
        <img src="images/Takt44.png">
        <img src="images/Takt48.png">
        <img src="images/Takt64.png">
        <img src="images/Takt68.png">
        <img src="images/TaktC.png">
        <img src="images/TaktAllabreve.png">
    </div>
    <div id="whitePage">
        <div id="Nadpis" contenteditable="true">New Project</div>
        <div id="MusicBY" contenteditable="true">Music by:</div>
        <div id="Arranged"contenteditable="true">Arranged by:</div>
        <div class="row" style="margin-top:200px;">
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c" id="special"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <img class="houslovyKEY" src="images/HouslovyKEY.png">
            <img class="takt" src="images/TaktC.png">
            <div class="tempo"><img style="height:20px" src="images/ctvrtovaNota.png"> = <p contenteditable="true">60</p></div>
        </div>
        <div class="row" style="margin-top:50px">
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c" id="special"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <img class="houslovyKEY" src="images/HouslovyKEY.png">
        </div>
        <div class="row" style="margin-top:50px">
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c" id="special"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <img class="houslovyKEY" src="images/HouslovyKEY.png">
        </div>
        <div class="row" style="margin-top:50px">
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c" id="special"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <img class="houslovyKEY" src="images/HouslovyKEY.png">
        </div>
        <div class="row" style="margin-top:50px">
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c" id="special"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <img class="houslovyKEY" src="images/HouslovyKEY.png">
        </div>
        <div class="row" style="margin-top:50px">
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c" id="special"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <img class="houslovyKEY" src="images/HouslovyKEY.png">
        </div>
        <div class="row" style="margin-top:50px">
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c" id="special"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <img class="houslovyKEY" src="images/HouslovyKEY.png">
        </div>
        <div class="row" style="margin-top:50px">
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c" id="special"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <img class="houslovyKEY" src="images/HouslovyKEY.png">
        </div>
    </div>
    <!-- Vkládání not -->
    <script>
        const tools=["celaNota","pulovaNota","ctvrtovaNota","osminkaNota","sestnatinkaNota","tricetidvatinkaNota","sedesatictyritinkaNota","celaPomlka","pulovaPomlka","ctvrtovaPomlka","osminkaPomlka","sestnatinkovaPomlka","tricetidvatinkaPomlka","taktovaCara"];
        const takty=[]
        const page =document.getElementById("whitePage");
        const specialLine = document.getElementById("special");
        let selectedTool=50;
        let selectedX;
        let selectedY;
        let selectedH;
        x=document.getElementsByClassName("line");
        y=document.getElementsByClassName("space");
        for(let i=0;i<x.length;i++){
            x[i].onmouseenter=targetable;
            x[i].onmouseout=hideNote;
            x[i].onmousemove=moveWithNote;
            x[i].onmouseup=stopMovingNote;
        }
        for(let i=0;i<y.length;i++){
            y[i].onmouseenter=targetable;
            y[i].onmouseout=hideNote;
            y[i].onmousemove=moveWithNote;
            y[i].onmouseup=stopMovingNote;

        }
        boxes=document.getElementsByClassName("tool");
        for(let i=0;i<boxes.length;i++){
            boxes[i].onclick=selectNote;
        }
        function targetable(){
            if(selectedTool!=50){
                let divimg = document.createElement("div");
                let img = document.createElement("img");
                img.src = "images/"+tools[selectedTool]+".png";
                img.style.height = selectedH+"px";
                img.style.zIndex="5";
                divimg.classList.add("nota");
                divimg.classList.add("t");
                divimg.setAttribute("value",selectedTool);
                divimg.setAttribute("x",selectedX);
                divimg.setAttribute("y",selectedY);
                divimg.setAttribute("h",selectedH);
                divimg.style.top = selectedY+"px";
                divimg.style.left = window.event.clientX-page.getBoundingClientRect().left-selectedX+"px";
                img.onmousedown=moveNoteManually;
                divimg.onmouseup=stopMovingNote;
                divimg.onmouseenter=showOptions;;
                divimg.appendChild(img);
                if(selectedTool<7){
                    this.getElementsByClassName("c")[0].appendChild(divimg);
                }
                else{
                    specialLine.appendChild(divimg);
                }
            }else{
                movingNote = document.getElementsByClassName("t")[0];
                if(movingNote){
                    if(movingNote.getAttribute("value")<7){
                        this.getElementsByClassName("c")[0].appendChild(movingNote);
                    }
                    else{
                        specialLine.appendChild(movinNote);
                    }
                }
            }
        }
        function hideNote(){
            if(selectedTool==50){
            }
            else{
                if(document.getElementsByClassName("t")[0]){
                    document.getElementsByClassName("t")[0].remove();
                }
            }
        }       
        function moveWithNote(){
            movingDiv=document.getElementsByClassName("t")[0];
            if(movingDiv){
                movingDiv.style.left= window.event.clientX-page.getBoundingClientRect().left-movingDiv.getAttribute("x")+"px";
            }
        }
        function selectNote(){
            selectedTool=this.getAttribute("value");
            selectedX=this.getAttribute("x");
            selectedY=this.getAttribute("y");
            selectedH=this.getAttribute("h");
            for(i=0;i<boxes.length;i++){
                boxes[i].style.background="white";
            }
            this.style.background="radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(167,167,167,1) 100%)";
            
        }
        function moveNoteManually(){
            this.src="images/"+tools[this.getAttribute("value")]+"Orange.png";
            this.parentElement.classList.add("t");
        }
        function stopMovingNote(){
            movingNote=document.getElementsByClassName("t")[0].getElementsByTagName("img")[0];
            if(movingNote){
                movingNote.src="images/"+tools[movingNote.parentElement.getAttribute("value")]+".png";
                if(document.getElementsByClassName("option1")[0]){
                    document.getElementsByClassName("option1")[0].remove();
                }
                
                movingNote.parentElement.classList.remove("t");
            }
        }
        function showOptions(){
            if(selectedTool==50){
                this.getElementsByTagName("img")[0].src="images/"+tools[this.getAttribute("value")]+"Orange.png";
                if(!this.getElementsByClassName("options")[0]){
                    let options = `
                    <div class="options">
                        <img src="images/krizek.png" style="transform:rotate(-90deg) translateX(50px) rotate(90deg);" onmouseenter=barvitko>
                        <img src="images/becko.png" style="transform:rotate(-120deg) translateX(50px) rotate(120deg);">
                        <img src="images/odrazka.png" style="transform:rotate(-150deg) translateX(50px) rotate(150deg);">
                    </div>`;


                    this.insertAdjacentHTML("beforeend",options);
                    document.getElementsByClassName("options")[0].onmouseleave=function(){
                        this.parentElement.getElementsByTagName("img")[0].src="images/"+tools[this.parentElement.getAttribute("value")]+".png";
                        this.remove();
                    }
                }
            }
        }
        function barvitko(){
            console.log()
            this.style.background="rgb(236, 160, 160)"
        }
    </script>
    <!-- Dragging system -->
    <script>
        dragElement(document.getElementById("tools"));

        function dragElement(elmnt) {
        var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;

        document.getElementById("tools").onmousedown = dragMouseDown;


        function dragMouseDown(e) {
            e = e || window.event;
            e.preventDefault();
            // get the mouse cursor position at startup:
            pos3 = e.clientX;
            pos4 = e.clientY;
            document.onmouseup = closeDragElement;
            // call a function whenever the cursor moves:
            document.onmousemove = elementDrag;
        }

        function elementDrag(e) {
            e = e || window.event;
            e.preventDefault();
            // calculate the new cursor position:
            pos1 = pos3 - e.clientX;
            pos2 = pos4 - e.clientY;
            pos3 = e.clientX;
            pos4 = e.clientY;
            // set the element's new position:
            elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
            elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
        }

        function closeDragElement() {
            /* stop moving when mouse button is released:*/
            document.onmouseup = null;
            document.onmousemove = null;
        }
        }
    </script>
    <!-- On Key pressed -->
    <script>
        document.addEventListener("keydown",function(e){
            if(e.key==="Escape"){
                div=document.getElementsByClassName("t")[0];
                if(selectedTool<7){
                    if(div){
                        div.remove();
                    }
                }
                else if(selectedTool==50){
                }
                else{
                    if(div){
                        div.remove();
                    }
                }
                for(i=0;i<boxes.length;i++){
                    boxes[i].style.background="white";
                }
                document.getElementById("cursor").style.background="radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(167,167,167,1) 100%)";
                selectedTool="50";
                selectedX="";
                selectedY="";
                selectedH="";
            }
        })
        document.onclick=function(){
            if(CanClickAnyWhere==1){
                nabidkaTakty.style.display="none";
            }
            else{
                CanClickAnyWhere-=1;
            }
        }
    </script>
    <!-- Takty -->
    <script>

        x=document.getElementsByClassName("takt");
        const nabidkaTakty =document.getElementById("Tacts");
        let n;
        CanClickAnyWhere=2;
        function showTacts(){
            nabidkaTakty.style.display="grid";
            nabidkaTakty.style.top=this.getBoundingClientRect().top+50+"px";
            nabidkaTakty.style.left=this.getBoundingClientRect().left+"px";
            CanClickAnyWhere=2;
            n=this
        }
        for(let i=0;i<x.length;i++){
            x[0].onclick=showTacts;
        }
        y=nabidkaTakty.getElementsByTagName("img");
        for(let i=0;i<y.length;i++){
            y[i].onclick=function(){
                n.src=y[i].src;
            }
        }
    </script>
</body>
</html>