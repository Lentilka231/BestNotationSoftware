<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="stylesheets/newproject.css">
    <meta charset="UTF-8">
    <title>New Project</title>
</head>
<body>
    <div id="mainBar">
        <div class="cell">
            <img src="images/newDocument.png" style="height:30px">
            <div>Nový dokument</div>
        </div>
        <div class="cell" onclick="keys()">
            <img src="images/HouslovyKEY.png" >
            <div>Klíč</div>
        </div>
        <div class="cell" onclick="stupnice()" >
            <img src="images/klomenob.png">
            <div>Stupnice</div>
        </div>
        <div class="cell">
            <img src="images/HouslovyKEY.png">
            <div>Dynamika</div>
        </div>
        <div class="cell">
            <img src="images/HouslovyKEY.png">
            <div>Opakování</div>
        </div>

    </div>
    <div id="keysBar">
        <img src="images/HouslovyKEY.png" onclick="keyChange(0)">
        <img src="images/BasovyKEY.png" onclick="keyChange(1)">
        <img src="images/AltovyKey.png" onclick="keyChange(2)">
    </div>
    <div id="stupniceBar">
        <div style="position:relative">
            <div id="UkazatelDS"  value="UDS">
                <img src="images/ukazatelS.png" style="height:25px;pointer-events: none" >
            </div>
            <div class="stupniceL">
            </div>
        </div>
    </div>
    <div id="tools">
        <div class="tool" h="" x="" y="" id="cursor" value="50" style="background:radial-gradient(circle, rgb(255, 255, 255) 0%, rgb(167, 167, 167) 100%)"><img src="images/cursor.png"></div>
        <div class="" h="" x="" y="" value=""></div>
        <div class="" h="" x="" y="" value=""></div>
        <div class="" h="" x="" y="" value=""></div>
        <div class="" h="" x="" y="" value=""></div>
        <div class="" h="" x="" y="" value=""></div>
        <div class="tool" h="38" x="50" y="-19" posuvka="-10" value="0"><img src="images/celaNota.png"></div>
        <div class="tool" h="38" x="50" y="-19" posuvka="-10" value="1"><img src="images/pulovaNota.png"></div>
        <div class="tool" h="38" x="50" y="-19" posuvka="-10" value="2"><img src="images/ctvrtovaNota.png"></div>
        <div class="tool" h="38" x="50" y="-19" posuvka="-10" value="3"><img src="images/osminkaNota.png"></div>
        <div class="tool" h="38" x="49" y="-19" posuvka="-10" value="4"><img src="images/sestnatinkaNota.png"></div>
        <div class="tool" h="38" x="49" y="-19" posuvka="-10" value="5"><img src="images/tricetidvatinkaNota.png"></div>
        <div class="tool" h="35" x="58" y="-8" posuvka="0" value="7"><img src="images/celaPomlka.png"></div>
        <div class="tool" h="35" x="58" y="-8" posuvka="0" value="8"><img src="images/pulovaPomlka.png"></div>
        <div class="tool" h="35" x="50" y="-8" posuvka="0" value="9"><img src="images/ctvrtovaPomlka.png"></div>
        <div class="tool" h="35" x="50" y="-8" posuvka="0" value="10"><img src="images/osminkaPomlka.png"></div>
        <div class="tool" h="35" x="50" y="-3" posuvka="0" value="11"><img src="images/sestnatinkovaPomlka.png"></div>
        <div class="tool" h="40" x="58" y="-6" posuvka="0" value="12"><img src="images/tricetidvatinkaPomlka.png"></div>
        <div class="tool" h="45" x="48" y="-8" posuvka="0" value="13"><img src="images/taktovaCara.png"></div>
    </div>
    <div id="Tacts">
        <img src="images/Takt22.png">
        <img src="images/Takt24.png">
        <img src="images/Takt28.png">
        <img src="images/Takt32.png">
        <img src="images/Takt34.png">
        <img src="images/Takt38.png">
        <img src="images/Takt44.png">
        <img src="images/Takt48.png">
        <img src="images/Takt64.png">
        <img src="images/Takt68.png">
        <img src="images/TaktC.png">
        <img src="images/TaktAllabreve.png">
    </div>
    <div id="whitePage">
        <div id="Nadpis" contenteditable="true">New Project</div>
        <div id="MusicBY" contenteditable="true">Music by:</div>
        <div id="Arranged"contenteditable="true">Arranged by:</div>
        <div class="row" style="margin-top:200px;">
            <div class="space" TonVzhuruNohama="t" x="4" y="7"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t" x="4" y="3"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t" x="3" y="7"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t" x="3" y="3"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t" x="2" y="7"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t" x="2" y="3"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t" x="1" y="7"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t" x="1" y="3"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t"><div class="c"></div></div>
            <div class="line" TonVzhuruNohama="t"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"prostredniTony="1" TonVzhuruNohama="t"><div class="c"></div></div>
            <div class="line" prostredniTony="2"TonVzhuruNohama="t" middle="t"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"prostredniTony="3" TonVzhuruNohama="t"><div class="c"></div></div>
            <div class="line" prostredniTony="4" TonVzhuruNohama="t" middle="t"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"prostredniTony="3"><div class="c"></div></div>
            <div class="line" prostredniTony="2"middle="t"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"prostredniTony="1"><div class="c"></div></div>
            <div class="line" ><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="space" x="-1" y="2"><div class="c"></div></div>
            <div class="space" x="-1" y="6"><div class="c"></div></div>
            <div class="space" x="-2" y="2"><div class="c"></div></div>
            <div class="space" x="-2" y="6"><div class="c"></div></div>
            <div class="space" x="-3" y="2"><div class="c"></div></div>
            <div class="space" x="-3" y="6"><div class="c"></div></div>
            <div class="space" x="-4" y="2"><div class="c"></div></div>
            <div class="space" x="-4" y="6"><div class="c"></div></div>
            <div class="naLince">
                <img class="key" src="images/HouslovyKEY.png">
                <div class="preznamenani" id="prvnipreznameni"><img src=""></div>
                <img class="takt" src="images/TaktC.png">
            </div>
            <div class="tempo"><img style="height:20px" src="images/ctvrtovaNota.png"> = <p contenteditable="true">60</p></div>
            <div class="konecniTakt"></div>
        </div>
        <div class="row" style="margin-top:75px;">
            <div class="space" TonVzhuruNohama="t" x="4" y="7"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t" x="4" y="3"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t" x="3" y="7"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t" x="3" y="3"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t" x="2" y="7"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t" x="2" y="3"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t" x="1" y="7"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t" x="1" y="3"><div class="c"></div></div>
            <div class="space" TonVzhuruNohama="t"><div class="c"></div></div>
            <div class="line" TonVzhuruNohama="t"><div class="c"></div><div class="blackline"></div></div>
            <div class="space" TonVzhuruNohama="t"><div class="c"></div></div>
            <div class="line" TonVzhuruNohama="t"><div class="c"></div><div class="blackline"></div></div>
            <div class="space" TonVzhuruNohama="t"><div class="c"></div></div>
            <div class="line" TonVzhuruNohama="t"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="line"><div class="c"></div><div class="blackline"></div></div>
            <div class="space"><div class="c"></div></div>
            <div class="space" x="-1" y="2"><div class="c"></div></div>
            <div class="space" x="-1" y="6"><div class="c"></div></div>
            <div class="space" x="-2" y="2"><div class="c"></div></div>
            <div class="space" x="-2" y="6"><div class="c"></div></div>
            <div class="space" x="-3" y="2"><div class="c"></div></div>
            <div class="space" x="-3" y="6"><div class="c"></div></div>
            <div class="space" x="-4" y="2"><div class="c"></div></div>
            <div class="space" x="-4" y="6"><div class="c"></div></div>
            <div class="naLince">
                <img class="key" src="images/HouslovyKEY.png">
                <div class="preznamenani"><img src=""></div>
            </div>
            <div class="konecniTakt"></div>
        </div>
    <!-- Vkládání not -->
    <script>
        const tools=["celaNota","pulovaNota","ctvrtovaNota","osminkaNota","sestnatinkaNota","tricetidvatinkaNota","sedesatictyritinkaNota","celaPomlka","pulovaPomlka","ctvrtovaPomlka","osminkaPomlka","sestnatinkovaPomlka","tricetidvatinkaPomlka","taktovaCara"];
        const page =document.getElementById("whitePage");
        let selectedTool=50;
        let selectedX;
        let selectedY;
        let selectedH;
        let selectedPosuvka;
        x=document.getElementsByClassName("line");
        y=document.getElementsByClassName("space");
        for(let i=0;i<x.length;i++){
            x[i].onmouseenter=targetable;
            x[i].onmouseout=hideNote;
            x[i].onmousemove=moveWithNote;
            x[i].onmouseup=stopMovingNote;
        }
        for(let i=0;i<y.length;i++){
            y[i].onmouseenter=targetable;
            y[i].onmouseout=hideNote;
            y[i].onmousemove=moveWithNote;
            y[i].onmouseup=stopMovingNote;
        }

        boxes=document.getElementsByClassName("tool");
        for(let i=0;i<boxes.length;i++){
            boxes[i].onclick=selectNote;
        }
        function targetable(){
            if(selectedTool!=50){
                let divimg = document.createElement("div");
                let img = document.createElement("img");
                let containImg =document.createElement("div"); 
                containImg.style.position="relative";
                containImg.classList.add("cImg");
                if(this.getAttribute("TonVzhuruNohama")&&selectedTool>0&&selectedTool<7){
                    img.src = "images/"+tools[selectedTool]+"O.png";
                    img.style.marginTop="21px";
                }else{
                    img.src = "images/"+tools[selectedTool]+".png";
                    img.style.marginTop="0px";
                }
                img.style.height = selectedH+"px";
                containImg.style.height=selectedH+"px";
                containImg.style.zIndex="5";
                img.classList.add("n");
                divimg.classList.add("nota");
                divimg.classList.add("t");
                divimg.setAttribute("value",selectedTool);
                divimg.setAttribute("x",selectedX);
                divimg.setAttribute("y",selectedY);
                divimg.setAttribute("h",selectedH);
                divimg.setAttribute("posuvka",selectedPosuvka);
                divimg.style.top = selectedY+"px";
                divimg.style.left = window.event.clientX-page.getBoundingClientRect().left-selectedX+"px";
                containImg.onmousedown=moveNoteManually;
                containImg.onmouseup=stopMovingNote;
                divimg.onmouseenter=showOptions;
                containImg.appendChild(img)
                divimg.appendChild(containImg);
                if(this.getAttribute("x")&&selectedTool<7){
                    let container = document.createElement("div");
                    if(this.getAttribute("x")<0){
                        container.style.bottom=+this.getAttribute("y")+ +selectedPosuvka+ -1+"px";
                        container.style.position="absolute";
                        container.classList.add("helpLine");
                        for(let i=0;i<Math.abs(this.getAttribute("x"));i++){
                            let space= document.createElement("div");
                            let line=document.createElement("div");
                            space.style.width="20px";
                            space.style.height="8px";
                            line.style.height="1px";
                            line.style.backgroundColor="black";
                            space.appendChild(line)
                            container.appendChild(space);
                        }
                        divimg.appendChild(container);
                    }else if(this.getAttribute("x")>0){
                        container.style.top=+this.getAttribute("y")+ -selectedPosuvka+ +1+"px";                        
                        container.style.position="absolute";
                        container.classList.add("helpLine");
                        for(let i=0;i<Math.abs(this.getAttribute("x"));i++){
                            let space= document.createElement("div");
                            let line=document.createElement("div");
                            space.style.width="20px";
                            space.style.height="8px";
                            space.style.position="relative";
                            line.style.height="1px";
                            line.style.width="20px";
                            line.style.backgroundColor="black";
                            line.style.bottom="0px";
                            line.style.position="absolute";
                            space.appendChild(line)
                            container.appendChild(space);
                        }
                        divimg.appendChild(container);
                    }
                }
                if(selectedTool<7){
                    this.getElementsByClassName("c")[0].appendChild(divimg);
                }
                else{
                    this.parentElement.getElementsByClassName("line")[2].appendChild(divimg);
                }
            }
            else{
                movingNote = document.getElementsByClassName("t")[0];
                if(movingNote){
                    if(movingNote.getAttribute("value")<7){
                        if(this.getAttribute("TonVzhuruNohama")&&movingNote.getAttribute("value")!=0){
                            movingNote.getElementsByClassName("n")[0].src = "images/"+tools[movingNote.getAttribute("value")]+"O.png";
                            movingNote.getElementsByClassName("n")[0].style.marginTop="21px";
                        }else{
                            movingNote.getElementsByClassName("n")[0].src = "images/"+tools[movingNote.getAttribute("value")]+".png";
                            movingNote.getElementsByClassName("n")[0].style.marginTop="0px";
                        }
                        if(movingNote.getElementsByClassName("helpLine")[0]){
                            movingNote.getElementsByClassName("helpLine")[0].remove();
                        }
                        if(movingNote.getElementsByClassName("znamenko")[0]){
                            znakImg = movingNote.getElementsByClassName("znamenko")[0];
                            let j =znakImg.getAttribute("znak");
                            if(j=="akcent1"){
                                if(this.getAttribute("prostredniTony")){
                                    znakImg.style.top=this.getAttribute("TonVzhuruNohama")?
                                    -5*this.getAttribute("prostredniTony")+ +8+"px":
                                    +5*this.getAttribute("prostredniTony")+ +32+"px";
                                }else{
                                    znakImg.style.top=this.getAttribute("TonVzhuruNohama")?"3px":"27px";
                                }
                            }
                            else if(j=="tenuto"){
                                if(this.getAttribute("middle")){
                                    znakImg.style.top=this.getAttribute("TonVzhuruNohama")?"-5px":"22px";
                                }
                                else{
                                    znakImg.style.top=this.getAttribute("TonVzhuruNohama")?"-1px":"18px";
                                }
                            }
                            else if(j=="prodluzovak"){
                                znakImg.style.top=this.classList.contains("line")||(this.getAttribute("y")||5)<4?"11px":"15px";
                            }
                            else if(j=="staccato"){
                                if(this.getAttribute("middle")){
                                    znakImg.style.top=this.getAttribute("TonVzhuruNohama")?"2px":"30px";
                                }else{
                                    znakImg.style.top=this.getAttribute("TonVzhuruNohama")?"6px":"25px";
                                }
                            }
                        }
                        if(this.getAttribute("x")){
                            let container = document.createElement("div");
                            
                            if(this.getAttribute("x")<0){
                                container.style.bottom=+this.getAttribute("y")+ +movingNote.getAttribute("posuvka")+ -1+"px";
                                container.style.position="absolute";
                                container.classList.add("helpLine");
                                for(let i=0;i<Math.abs(this.getAttribute("x"));i++){
                                    let space= document.createElement("div");
                                    let line=document.createElement("div");
                                    space.style.width="20px";
                                    space.style.height="8px";
                                    line.style.height="1px";
                                    line.style.backgroundColor="black";
                                    space.appendChild(line)
                                    container.appendChild(space);
                                }
                                movingNote.appendChild(container);
                            }
                            else if(this.getAttribute("x")>0){
                                container.style.top=+this.getAttribute("y")+ -movingNote.getAttribute("posuvka")+ +1+"px";                        
                                container.style.position="absolute";
                                container.classList.add("helpLine");
                                for(let i=0;i<Math.abs(this.getAttribute("x"));i++){
                                    let space= document.createElement("div");
                                    let line=document.createElement("div");
                                    space.style.width="20px";
                                    space.style.height="8px";
                                    space.style.position="relative";
                                    line.style.height="1px";
                                    line.style.width="20px";
                                    line.style.backgroundColor="black";
                                    line.style.bottom="0px";
                                    line.style.position="absolute";
                                    space.appendChild(line)
                                    container.appendChild(space);
                                }
                                movingNote.appendChild(container);
                            }
                        }
                        this.getElementsByClassName("c")[0].appendChild(movingNote);
                    }
                    else{
                        this.parentElement.getElementsByClassName("line")[2].appendChild(movingNote);
                    }
                }
            }
        }
        function hideNote(){
            if(selectedTool==50){
            }
            else{
                if(document.getElementsByClassName("t")[0]){
                    document.getElementsByClassName("t")[0].remove();
                }
            }
        }       
        function moveWithNote(){
            movingDiv=document.getElementsByClassName("t")[0];
            if(movingDiv){
                movingDiv.style.left= window.event.clientX-page.getBoundingClientRect().left-movingDiv.getAttribute("x")+"px";
            }
        }
        function selectNote(e,vN){
            vybranaNota=vN||this;
            if(document.getElementsByClassName("t")[0]){
                document.getElementsByClassName("t")[0].remove();
            }
            selectedTool=vybranaNota.getAttribute("value");
            selectedX=vybranaNota.getAttribute("x");
            selectedY=vybranaNota.getAttribute("y");
            selectedH=vybranaNota.getAttribute("h");
            selectedPosuvka=vybranaNota.getAttribute("posuvka");
            for(i=0;i<boxes.length;i++){
                boxes[i].style.background="white";
            }
            vybranaNota.style.background="radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(167,167,167,1) 100%)";
            
        }
        function moveNoteManually(){
            if(this.parentElement.classList.contains("options")){
                this.parentElement.parentElement.appendChild(this);
                this.parentElement.classList.add("t");
                this.parentElement.style.zIndex=-1;
                this.parentElement.getElementsByClassName("options")[0].remove();
            }
        }
        function stopMovingNote(){
            if(document.getElementsByClassName("t")[0]){
                movingNote=document.getElementsByClassName("t")[0].getElementsByClassName("cImg")[0].getElementsByClassName("n")[0];
                if(movingNote.parentElement.parentElement.parentElement.parentElement.getAttribute("TonVzhuruNohama")&&movingNote.parentElement.parentElement.getAttribute("value")!=0){
                    movingNote.src="images/"+tools[movingNote.parentElement.parentElement.getAttribute("value")]+"O.png";
                    movingNote.style.marginTop="21px";
                }else{
                    movingNote.src="images/"+tools[movingNote.parentElement.parentElement.getAttribute("value")]+".png";
                    movingNote.style.marginTop="0px";
                }
                movingNote.parentElement.parentElement.classList.remove("t");
                movingNote.parentElement.parentElement.style.zIndex=2;
            }
        }
        function notedelete(){
            this.parentElement.parentElement.remove();
        }
        function posuvka(){
            if(this.parentElement.parentElement.getElementsByClassName("posuvka")[0]){
                if(this.src==this.parentElement.parentElement.getElementsByClassName("posuvka")[0].src){
                    this.parentElement.parentElement.getElementsByClassName("posuvka")[0].remove();
                    return
                }
                this.parentElement.parentElement.getElementsByClassName("posuvka")[0].remove();
            }
            znakImg = document.createElement("img");
            znakImg.classList.add("posuvka");
            znakImg.src=this.src;
            znakImg.style.position="absolute";
            znakImg.style.top=+this.parentElement.parentElement.getAttribute("posuvka")+ +this.getAttribute("top")+"px";
            this.parentElement.parentElement.getElementsByClassName("cImg")[0].appendChild(znakImg);
        }
        function znamenko(){
            if(this.parentElement.parentElement.getElementsByClassName("znamenko")[0]){
                if(this.src==this.parentElement.parentElement.getElementsByClassName("znamenko")[0].src){
                    this.parentElement.parentElement.getElementsByClassName("znamenko")[0].remove();
                    return
                }
                this.parentElement.parentElement.getElementsByClassName("znamenko")[0].remove();
            }
            znakImg = document.createElement("img");
            znakImg.classList.add("znamenko");
            znakImg.setAttribute("top",this.getAttribute("top"));
            znakImg.src=this.src;
            znakImg.style.position="absolute";
            znakImg.setAttribute("znak",this.getAttribute("znak"));

            let k=this.parentElement.parentElement.getAttribute("value")
            let j=this.getAttribute("znak");
            let radek=this.parentElement.parentElement.parentElement.parentElement;
            if(j=="akcent1"){
                if(radek.getAttribute("prostredniTony")){
                    znakImg.style.top=radek.getAttribute("TonVzhuruNohama")?
                    -5*radek.getAttribute("prostredniTony")+ +8+"px":
                    +5*radek.getAttribute("prostredniTony")+ +22+"px";
                }else{
                    znakImg.style.top=radek.getAttribute("TonVzhuruNohama")?"3px":"27px";
                }
                if(radek.getAttribute("TonVzhuruNohama")){
                    znakImg.style.left= 
                    k==0?"1px":
                    k==1||k==2?"-1px":
                    k==3||k==4?"2px":
                    "1px";
                }
                else{
                    znakImg.style.left= 
                    k==0?"0px":
                    k==1||k==2?"-2px":
                    k==3||k==4?"3px":
                    "1px";
                }
            }
            else if(j=="tenuto"){
                if(radek.getAttribute("middle")){
                    znakImg.style.top=radek.getAttribute("TonVzhuruNohama")?"-5px":"22px";
                }else{
                    znakImg.style.top=radek.getAttribute("TonVzhuruNohama")?"-1px":"18px";
                }
                if(radek.getAttribute("TonVzhuruNohama")){
                    znakImg.style.left= 
                    k==0?"1px":
                    k==1||k==2?"-1px":
                    k==3||k==4?"2px":
                    "1px";
                }
                else{
                    znakImg.style.left= 
                    k==0?"0px":
                    k==1||k==2?"-2px":
                    k==3||k==4?"3px":
                    "1px";
                }
            }
            else if(j=="prodluzovak")
            {
                znakImg.style.top=radek.classList.contains("line")||(radek.getAttribute("y")||5)<4?"11px":"15px";
                if(radek.getAttribute("TonVzhuruNohama")){
                    znakImg.style.left= 
                    k==0?"5px":
                    k==1||k==2?"2px":
                    k==3||k==4?"5px":
                    "4px";
                }else{
                    znakImg.style.left= 
                    k==0?"5px":
                    k==1||k==2?"1px":
                    k==3||k==4?"5px":
                    "4px";
                }
            }
            else if(j=="staccato"){
                if(radek.getAttribute("middle")){
                    znakImg.style.top=radek.getAttribute("TonVzhuruNohama")?"2px":"30px";
                }else{
                    znakImg.style.top=radek.getAttribute("TonVzhuruNohama")?"6px":"25px";
                }
                if(radek.getAttribute("TonVzhuruNohama")){
                    znakImg.style.left= 
                    k==0?"-6px":
                    k==1||k==2?"-6px":
                    k==3||k==4?"-4px":
                    "-5px";
                }
                else{
                    znakImg.style.left= 
                    k==0?"-6px":
                    k==1||k==2?"-8px":
                    k==3||k==4?"-3px":
                    "-4px";
                }
            }
            else if(j=="korunka"){
                if(radek.getAttribute("prostredniTony")){
                    znakImg.style.top=radek.getAttribute("TonVzhuruNohama")?
                    -5*radek.getAttribute("prostredniTony")+ +8+"px":
                    +5*radek.getAttribute("prostredniTony")+ +22+"px";
                }else{
                    znakImg.style.top=radek.getAttribute("TonVzhuruNohama")?"3px":"27px";
                }
                if(radek.getAttribute("TonVzhuruNohama")){
                    znakImg.style.left= 
                    k==0?"0px":
                    k==1||k==2?"-1px":
                    k==3||k==4?"1px":
                    "1px";
                }
                else{
                    znakImg.style.left= 
                    k==0?"-1px":
                    k==1||k==2?"-2px":
                    k==3||k==4?"2px":
                    "1px";
                }
            }
            this.parentElement.parentElement.getElementsByClassName("cImg")[0].appendChild(znakImg);
        }
        const znamenka=["krizek","becko","odrazka","akcent1","tenuto","prodluzovak","staccato","korunka","krizekk"];

        function showOptions(){
            if(selectedTool==50&&!(document.getElementsByClassName("options")[0])&&!(document.getElementsByClassName("t")[0])){
                if(document.getElementsByClassName("options")[0]){
                    document.getElementsByClassName("options")[0].parentElement.appendChild(document.getElementsByClassName("options")[0]);
                    document.getElementsByClassName("options")[0].remove();
                }
                this.style.zIndex=5
                if(this.parentElement.parentElement.getAttribute("TonVzhuruNohama")&&this.getAttribute("value")!=0){
                    this.getElementsByClassName("n")[0].src="images/"+tools[this.getAttribute("value")]+"OrangeO.png";
                    this.getElementsByClassName("n")[0].style.marginTop="21px";
                }else{
                    this.getElementsByClassName("n")[0].src="images/"+tools[this.getAttribute("value")]+"Orange.png";
                    this.getElementsByClassName("n")[0].style.marginTop="0px";
                }
                
                if(!this.getElementsByClassName("options")[0]){
                    if(this.getAttribute("value")<7){
                        this.parentElement.parentElement.parentElement.style.zIndex=2;  
                        divOptions=document.createElement("div");
                        divOptions.classList.add("options");
                        let b=[posuvka,posuvka,posuvka,znamenko,znamenko,znamenko,znamenko,znamenko,notedelete];
                        let top=[26,22,26];
                        for(let i=0;i<znamenka.length;i++){
                            imgV=document.createElement("img");
                            imgV.src="images/"+znamenka[i]+".png";
                            imgV.setAttribute("znak",znamenka[i]);
                            imgV.classList.add("v");
                            imgV.style.transform=`rotate(${-90-i*30}deg) translateX(60px) rotate(${90+i*30}deg)`
                            imgV.onmouseenter=function(){this.style.height="32px"};
                            imgV.onmouseleave=function(){this.style.height="30px"};
                            imgV.onclick=b[i];
                            imgV.setAttribute("top",top[i])
                            divOptions.appendChild(imgV);
                        }
                        this.appendChild(divOptions);
                        this.getElementsByClassName("options")[0].appendChild(this.getElementsByClassName("cImg")[0]);
                        document.getElementsByClassName("options")[0].onmouseleave=function(){
                            if(this.parentElement.parentElement.parentElement.getAttribute("TonVzhuruNohama")&&this.parentElement.getAttribute("value")!=0){
                                this.parentElement.getElementsByClassName("n")[0].src="images/"+tools[this.parentElement.getAttribute("value")]+"O.png";
                                this.parentElement.getElementsByClassName("n")[0].style.marginTop="21px";
                            }else{
                                this.parentElement.getElementsByClassName("n")[0].src="images/"+tools[this.parentElement.getAttribute("value")]+".png";
                                this.getElementsByClassName("n")[0].style.marginTop="0px";
                            }
                            this.parentElement.appendChild(this.parentElement.getElementsByClassName("cImg")[0]);
                            this.parentElement.style.zIndex=2;
                            this.parentElement.parentElement.parentElement.parentElement.style.zIndex=0;  
                            this.remove();
                        }
                    }
                    else if(this.getAttribute("value")<13){
                        divOptions=document.createElement("div");
                        divOptions.classList.add("options");
                        a=["images/krizek.png","images/becko.png","images/odrazka.png","images/krizekk.png"];
                        b=[posuvka,posuvka,posuvka,notedelete];
                        for(let i=0;i<4;i++){
                            imgV=document.createElement("img");
                            imgV.src=a[i];
                            imgV.classList.add("v");
                            imgV.style.transform=`rotate(${-90-i*30}deg) translateX(60px) rotate(${90+i*30}deg)`
                            imgV.onmouseenter=function(){this.style.height="32px"};
                            imgV.onmouseleave=function(){this.style.height="30px"};
                            imgV.onclick=b[i];
                            divOptions.appendChild(imgV);
                        }
                        this.appendChild(divOptions);
                        this.getElementsByClassName("options")[0].appendChild(this.getElementsByClassName("cImg")[0]);
                        document.getElementsByClassName("options")[0].onmouseleave=function(){
                            this.parentElement.getElementsByClassName("n")[0].src="images/"+tools[this.parentElement.getAttribute("value")]+".png";
                            this.parentElement.appendChild(this.parentElement.getElementsByClassName("cImg")[0]);
                            this.remove();
                        }
                    }
                    else if(this.getAttribute("value")==13){
                        divOptions=document.createElement("div");
                        divOptions.classList.add("options");
                        a=["images/krizek.png","images/becko.png","images/odrazka.png","images/krizekk.png"];
                        b=[posuvka,posuvka,posuvka,notedelete];
                        for(let i=0;i<4;i++){
                            imgV=document.createElement("img");
                            imgV.src=a[i];
                            imgV.classList.add("v");
                            imgV.style.transform=`rotate(${-90-i*30}deg) translateX(60px) rotate(${90+i*30}deg)`
                            imgV.onmouseenter=function(){this.style.height="32px"};
                            imgV.onmouseleave=function(){this.style.height="30px"};
                            imgV.onclick=b[i];
                            divOptions.appendChild(imgV);
                        }
                        this.appendChild(divOptions);
                        this.getElementsByClassName("options")[0].appendChild(this.getElementsByClassName("cImg")[0]);
                        document.getElementsByClassName("options")[0].onmouseleave=function(){
                            this.parentElement.getElementsByClassName("n")[0].src="images/"+tools[this.parentElement.getAttribute("value")]+".png";
                            
                            this.parentElement.appendChild(this.parentElement.getElementsByClassName("cImg")[0]);
                            this.remove();
                        }
                    }
                }
            }
        }

    </script>
    <!-- Dragging system -->
    <script>
        dragElement(document.getElementById("tools"));

        function dragElement(elmnt) {
        var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;

        document.getElementById("tools").onmousedown = dragMouseDown;


        function dragMouseDown(e) {
            e = e || window.event;
            e.preventDefault();
            // get the mouse cursor position at startup:
            pos3 = e.clientX;
            pos4 = e.clientY;
            document.onmouseup = closeDragElement;
            // call a function whenever the cursor moves:
            document.onmousemove = elementDrag;
        }

        function elementDrag(e) {
            e = e || window.event;
            e.preventDefault();
            // calculate the new cursor position:
            pos1 = pos3 - e.clientX;
            pos2 = pos4 - e.clientY;
            pos3 = e.clientX;
            pos4 = e.clientY;
            // set the element's new position:
            elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
            elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
        }

        function closeDragElement() {
            /* stop moving when mouse button is released:*/
            document.onmouseup = null;
            document.onmousemove = null;
        }
        }
    </script>
    <!-- On Key pressed -->
    <script>
        document.addEventListener("keydown",function(e){
            if(e.key==="Escape"){
                div=document.getElementsByClassName("t")[0];
                if(selectedTool<7){
                    if(div){
                        div.remove();
                    }
                }
                else if(selectedTool==50){
                }
                else{
                    if(div){
                        div.remove();
                    }
                }
                for(i=0;i<boxes.length;i++){
                    boxes[i].style.background="white";
                }
                document.getElementById("cursor").style.background="radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(167,167,167,1) 100%)";
                selectedTool="50";
                selectedX="";
                selectedY="";
                selectedH="";
            }
            if(e.key==="p"){
                debugger;
            };
            if(e.key==="q"){
                if(document.getElementsByClassName("t")[0]){
                    document.getElementsByClassName("t")[0].remove();
                }
                selectNote(null,document.getElementsByClassName("tool")[0]);
            }
            if(e.key==="w"){
                selectNote(null,document.getElementsByClassName("tool")[1]);
            }
            if(e.key==="e"){
                selectNote(null,document.getElementsByClassName("tool")[2]);
            }
            if(e.key==="r"){
                selectNote(null,document.getElementsByClassName("tool")[3]);
            }
            if(e.key==="t"){
                selectNote(null,document.getElementsByClassName("tool")[4]);
            }
            if(e.key==="z"){
                selectNote(null,document.getElementsByClassName("tool")[5]);
            }
            if(e.key==="u"){
                selectNote(null,document.getElementsByClassName("tool")[6]);
            }
            if(e.key==="s"){
                selectNote(null,document.getElementsByClassName("tool")[7]);
            }
            if(e.key==="d"){
                selectNote(null,document.getElementsByClassName("tool")[8]);
            }
            if(e.key==="f"){
                selectNote(null,document.getElementsByClassName("tool")[9]);
            }
            if(e.key==="g"){
                selectNote(null,document.getElementsByClassName("tool")[10]);
            }
            if(e.key==="h"){
                selectNote(null,document.getElementsByClassName("tool")[11]);
            }
            if(e.key==="j"){
                selectNote(null,jdocument.getElementsByClassName("tool")[12]);
            }
        })
        document.onclick=function(){
            if(CanClickAnyWhere==1){
                nabidkaTakty.style.display="none";
            }
            else{
                CanClickAnyWhere-=1;
            }
            if(canclickStupnice==1){
                document.getElementById("stupniceBar").style.display="none";
            }else{
                canclickStupnice-=1;
            }
            if(canclickKey==1){
                document.getElementById("keysBar").style.display="none";
            }else{
                canclickKey-=1;
            }

        }
        document.onmouseup=function(){
            if(cursor){
                cursor="";
            }
        }
    </script>   
    <!-- Takty -->
    <script>

        x=document.getElementsByClassName("takt");
        const nabidkaTakty =document.getElementById("Tacts");
        let n;
        CanClickAnyWhere=2;
        function showTacts(){
            nabidkaTakty.style.display="grid";
            nabidkaTakty.style.top=+this.getBoundingClientRect().top+50+"px";
            nabidkaTakty.style.left=this.getBoundingClientRect().left+"px";
            CanClickAnyWhere=2;
            n=this
        }
        for(let i=0;i<x.length;i++){
            x[0].onclick=showTacts;
        }
        y=nabidkaTakty.getElementsByTagName("img");
        for(let i=0;i<y.length;i++){
            y[i].onclick=function(){
                n.src=y[i].src;
            }
        }
    </script>
    <!-- Main Menu -->
    <script>
        canclickKey=0
        function keys(){
            document.getElementById("keysBar").style.display="flex";
            canclickKey=2;
        }
        const keysSRC=["images/HouslovyKEY.png","images/BasovyKEY.png","images/AltovyKEY.png"];
        const keyheight=[70,48,53]
        function keyChange(value){
            let keys=document.getElementsByClassName("key");
            for(let i=0;i<keys.length;i++){
                keys[i].src=keysSRC[value];
                keys[i].style.height=keyheight[value]+"px";
            }
        }

        stupniceDurove=["Ces","Ges","Des","As","Es","B","F","C","G","D","A","E","H","Fis","Cis"]
        canclickStupnice=0;
        let cursor="";
        document.getElementById("UkazatelDS").onmousedown=function(){cursor=this.getAttribute("value")};
        for(let i=0;i<15;i++){
            let sDiv=document.createElement("div");
            let text= document.createElement("div");
            text.innerText=stupniceDurove[i];
            text.classList.add("textstupnice")
            sDiv.appendChild(text);
            sDiv.classList.add("stupnice");
            sDiv.style.left=400/14*i+"px";
            document.getElementsByClassName("stupniceL")[0].appendChild(sDiv);

        }
        function stupnice(){
            canclickStupnice=2;
            document.getElementById("stupniceBar").style.top=+this.offsetTop + +20+"px"
            document.getElementById("stupniceBar").style.display="flex";
        }
        document.getElementById("stupniceBar").onclick=function(){
            canclickStupnice=2;
        }
        document.getElementById("stupniceBar").onmousemove=function(){
            if(cursor=="UDS"){
                
                for(let i=0;i<15;i++){
                    let h=window.event.clientX-document.getElementById("stupniceBar").getBoundingClientRect().left+ -35;

                    if(h>Math.round(400/14*i)-5&&h<Math.round(400/14*i)+5){
                        document.getElementById("UkazatelDS").style.left=Math.round(400/14*i)+"px";
                        preznamenani=document.getElementsByClassName("preznamenani");
                        for(let x=0;x<preznamenani.length;x++){
                            preznamenani[x].getElementsByTagName("img")[0].src="images/stupnice"+i+".png";
                            if(i==7){
                                preznamenani[x].getElementsByTagName("img")[0].src="";
                            }
                        }
                    }
                }
            }
        }
    
    
    </script>
</body>
</html>